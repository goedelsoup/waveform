# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: Â© 2025 Cory Parent <goedelsoup+waveform@goedelsoup.io>

# Advanced Contract Example: Multi-Signal Validation
# This contract demonstrates validation across traces, metrics, and logs
# with sophisticated cross-signal validation rules.

publisher: "ecommerce-api"
version: "2.1.0"
description: "E-commerce API contract with multi-signal validation and temporal rules"

pipeline_selectors:
  selectors:
    - field: "environment"
      operator: "equals"
      value: "production"
    - field: "service.name"
      operator: "starts_with"
      value: "ecommerce"
  priority: 5

inputs:
  traces:
    - span_name: "order_checkout"
      service_name: "ecommerce-api"
      attributes:
        order.id: "ord_12345"
        order.total: 299.99
        customer.id: "cust_67890"
        http.method: "POST"
        http.status_code: 201

  metrics:
    - name: "orders_completed_total"
      type: "counter"
      value: 1
      labels:
        service: "ecommerce-api"
        status: "success"

  logs:
    - body: "Order ord_12345 completed successfully"
      severity: "INFO"
      attributes:
        order.id: "ord_12345"
        customer.id: "cust_67890"
        event.type: "order.completed"

matchers:
  traces:
    - span_name: "order_checkout"
      service_name: "ecommerce-api"
      attributes:
        order.id: "ord_12345"
        order.total: 299.99
        customer.id: "cust_67890"
        http.method: "POST"
        http.status_code: 201

  metrics:
    - name: "orders_completed_total"
      type: "counter"
      labels:
        service: "ecommerce-api"
        status: "success"

  logs:
    - body: "Order ord_12345 completed successfully"
      severity: "INFO"
      attributes:
        order.id: "ord_12345"
        customer.id: "cust_67890"
        event.type: "order.completed"
